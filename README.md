# Bang-Olufsen-Linux

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏–æ –Ω–∞ –Ω–æ—É—Ç–±—É–∫–∞—Ö —Å Bang & Olufsen –∏ Intel SOF HDA DSP –≤ Linux.

---

## –¶–µ–ª—å

- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å–æ –∑–≤—É–∫–æ–º –Ω–∞ –Ω–æ—É—Ç–±—É–∫–∞—Ö —Å Bang & Olufsen –∏ Intel SOF HDA DSP.  
- –í–∫–ª—é—á–∏—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∏–Ω–∞–º–∏–∫–∏, –Ω–∞—É—à–Ω–∏–∫–∏ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω.  
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã.

---

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ —É—Å—Ç–∞–Ω–æ–≤–∏ –ø–∞–∫–µ—Ç—ã:

```
sudo apt update
sudo apt install alsa-tools alsa-tools-gui
```
alsa-tools —Å–æ–¥–µ—Ä–∂–∏—Ç hda-verb, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–µ–Ω –¥–ª—è –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–∏–Ω–æ–≤.

alsa-tools-gui ‚Äî –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

## 2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
–°–∫–∞—á–∞–π —Å–∫—Ä–∏–ø—Ç sof_fix_audio_auto.sh –∏ –ø–æ–º–µ—Å—Ç–∏ –µ–≥–æ –≤ usr/local/bin/:

```sudo cp sof_fix_audio_auto.sh /usr/local/bin/```
## 3. –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
```sudo chmod +x /usr/local/bin/sof_fix_audio_auto.sh```
## 4. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞

```sudo /usr/local/bin/sof_fix_audio_auto.sh```
–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤—Å–µ—Ö –ø–∏–Ω–æ–≤ (–¥–∏–Ω–∞–º–∏–∫–∏, –Ω–∞—É—à–Ω–∏–∫–∏, –º–∏–∫—Ä–æ—Ñ–æ–Ω) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç systemd-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏.

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
python-repl
–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Ä—Ç–∞ 0 (SOF HDA DSP)
–ü–∏–Ω 0x17 ‚Üí 0x40
–ü–∏–Ω 0x21 ‚Üí 0x40
‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SOF HDA DSP –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
–°–æ–∑–¥–∞—ë–º systemd-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏...
‚úÖ –°–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–Ω –∏ –≤–∫–ª—é—á–µ–Ω –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É.
```
## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∑–≤—É–∫–∞
5.1 –î–∏–Ω–∞–º–∏–∫–∏
```speaker-test -c2 -twav -Dhw:0,0```
–°–ª—É—à–∞–π –∑–≤—É–∫ —Å –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ—Å—Ç–∞ ‚Äî Ctrl+C.

5.2 –ù–∞—É—à–Ω–∏–∫–∏
```speaker-test -c2 -twav -Dhw:0,31```
–í—Å—Ç–∞–≤—å –Ω–∞—É—à–Ω–∏–∫–∏ –≤ —Ä–∞–∑—ä—ë–º.

–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–≤—É–∫ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ –Ω–∏—Ö.

5.3 –ú–∏–∫—Ä–æ—Ñ–æ–Ω
```arecord -l           # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
arecord -f cd -d 5 test_mic.wav
aplay test_mic.wav
```
–î–æ–ª–∂–µ–Ω –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –∑–≤—É–∫ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.

6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞:
```
systemctl status sof_fix_audio.service
```
–°—Ç–∞—Ç—É—Å active (exited) –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ.

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∑–≤—É–∫ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

7Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```
sudo reboot
```
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–Ω–∞–º–∏–∫–∏, –Ω–∞—É—à–Ω–∏–∫–∏ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω, –∫–∞–∫ –≤ –ø—É–Ω–∫—Ç–µ 5.


## –†–µ–∑—É–ª—å—Ç–∞—Ç
1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∏–Ω–∞–º–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

2. –ù–∞—É—à–Ω–∏–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

3. –ú–∏–∫—Ä–æ—Ñ–æ–Ω –∞–∫—Ç–∏–≤–µ–Ω.

4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

5. –ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hdajackretask.

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–µ
1. –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è / hda-verb –Ω–µ –Ω–∞–π–¥–µ–Ω
```
sudo apt update
sudo apt install alsa-tools
```
3. –ö–∞—Ä—Ç–∞ SOF HDA DSP –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```
aplay -l
```
–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞—Ä—Ç–∞ –≤–∏–¥–∞ sof-hda-dsp.

–ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ–±–Ω–æ–≤–∏—Ç–µ —è–¥—Ä–æ –∏ –¥—Ä–∞–π–≤–µ—Ä—ã:
```
sudo apt update
sudo apt upgrade
sudo apt install linux-sound-base linux-modules-extra-$(uname -r)
```
3. –ù–µ—Ç –∑–≤—É–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
–ü—Ä–æ–≤–µ—Ä—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤—ã–≤–æ–¥–∞:
```
speaker-test -c2 -twav -Dhw:0,0
```
–ï—Å–ª–∏ –∑–≤—É–∫ –µ—Å—Ç—å —á–µ—Ä–µ–∑ hw, –Ω–æ –Ω–µ—Ç —á–µ—Ä–µ–∑ PulseAudio/PipeWire ‚Äî –≤—ã–±–µ—Ä–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–∏—Å—Ç–µ–º—ã.

4. –ù–∞—É—à–Ω–∏–∫–∏ –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–°–∫—Ä–∏–ø—Ç –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –¥–∂–µ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PulseAudio/ALSA –∞–≤—Ç–æ—Å–≤–∏—á:
```
sudo apt install alsa-utils
alsactl init
```
5. –ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä—å pavucontrol –∏–ª–∏ alsamixer.

Node –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è ‚Üí –∏–∑–º–µ–Ω–∏—Ç—å Node ID –≤ —Å–∫—Ä–∏–ø—Ç–µ.

6. –°–µ—Ä–≤–∏—Å systemd –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

sudo systemctl daemon-reload
sudo systemctl enable sof_fix_audio.service
sudo systemctl start sof_fix_audio.service
üí° –°–æ–≤–µ—Ç: –ø–æ—Å–ª–µ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫.
